create database BIOMETRIC_SYSTEM;
use BIOMETRIC_SYSTEM;

  create table TIPO_DOCUMENTO
	(
    ID_TIPO_DOCUMENTO VARCHAR(45) NOT NULL,
    NOMBRE_T_D VARCHAR(45) NOT NULL,
    PRIMARY KEY(ID_TIPO_DOCUMENTO)
	);

	create table ROL
		(
			ID_ROL INT NOT NULL,
			NOMBRE_ROL VARCHAR(45) NOT NULL,
			ESTADO_ROL BOOLEAN NOT NULL,
			PRIMARY KEY (ID_ROL)
			);

		create table RH
			(
				ID_RH INT NOT NULL,
				NOMBRE_RH VARCHAR(45) NOT NULL,
				ESTADO_RH BOOLEAN NOT NULL,
				PRIMARY KEY(ID_RH)
				);

			create table CIUDAD
				(
					ID_CIUDAD INT NOT NULL,
					NOMBRE_CIUDAD VARCHAR(45) NOT NULL,
					ESTADO_CIUDAD BOOLEAN NOT NULL,
					PRIMARY KEY (ID_CIUDAD)
					);

				create table EPS
					(
						ID_EPS INT NOT NULL,
						NOMBRE_EPS VARCHAR(45) NOT NULL,
						ESTADO_EPS BOOLEAN NOT NULL,
						PRIMARY KEY (ID_EPS)
						);

					create table ACUDIENTE
						(
							ID_ACUDIENTE INT NOT NULL,
							ESTADO_ACUDIENTE BOOLEAN NOT NULL,
							PRIMARY KEY (ID_ACUDIENTE)
							);

						create table LOCALIDAD 
							(
								ID_LOCALIDAD INT NOT NULL,
								NOMBRE_LOCALIDAD VARCHAR(45) NOT NULL,
								ESTADO_LOCALIDAD BOOLEAN NOT NULL,
								PRIMARY KEY (ID_LOCALIDAD)
								);
							create table RECUPERCION_CONTRASENA
								(
									ID_RECUPERACION INT NOT NULL,
									CORREO VARCHAR(45) NOT NULL,
									PRIMARY KEY(ID_RECUPERACION)
									);

								create table LINEA_VEHICULO 
									(
										ID_LINEA_VEH INT NOT NULL,
										NOMBRE_L_VH VARCHAR(45)NOT NULL,
										ESTADO_LINEA_VH BOOLEAN NOT NULL,
										PRIMARY KEY(ID_LINEA_VEH)
										);

									create table PERSONA
										(
											ID_PERSONA INT NOT NULL,
											NOMBRE_PER VARCHAR(45)NOT NULL,
											APELLIDO_PER VARCHAR(45)NOT NULL,
											PRIMARY KEY(ID_PERSONA)
											);

										create table MARCA_VEHICULO
											(
												ID_MARCA_VEH INT NOT NULL,
												NOMBRE_MARCA_VEH VARCHAR(45)NOT NULL,
												ESTADO_M_V BOOLEAN NOT NULL,
												PRIMARY KEY(ID_MARCA_VEH)
												);

											create table TIPO_VEHICULO
												(
													ID_TIPO_VEH INT NOT NULL,
													NOMBRR_TIPO_VEH VARCHAR(45) NOT NULL,
													ESTADO_TIPO_VEH BOOLEAN NOT NULL,
													PRIMARY KEY(ID_TIPO_VEH)
													);

												create table CAMBIO_CONTRASENA
													(
														ID_CONTRASENA INT NOT NULL,
														CONTRA_ANTERIOR VARCHAR(45)NOT NULL,
														CONTRA_NUEVA VARCHAR (45) NOT NULL,
														CONTRA_NUEVA_CONFRIMADA VARCHAR(45) NOT NULL,
														PRIMARY KEY(ID_CONTRASENA)
														);

													create table USUARIO 
													(
														ID_USUARIO INT NOT NULL,
														TIPO_DOCIMENTO VARCHAR(45) NOT NULL,
														NUMERO_DOCUMENTO INT NOT NULL,
														CONTRASENA VARCHAR(45) NOT NULL,
														ESTADO_USUARIO BOOLEAN NOT NULL,
														ID_ROL INT NOT NULL,
														ID_CONTRASENA INT NOT NULL,
														PRIMARY KEY (ID_USUARIO)
														) ;

													create table TELEFONO
														(
															ID_TELEFONO INT NOT NULL,
															NUMERO_TEL INT NOT NULL,
															ID_PERSONA INT NOT NULL,
															PRIMARY KEY (ID_TELEFONO)
															);

														create table VEHICULO
															(
																PLACA_VEHICULO VARCHAR(45) NOT NULL,
																COLOR_VEHICULO VARCHAR(45) NOT NULL,
																MODELO_VEHICULO VARCHAR(45) NOT NULL,
																ESTADO_VEICULO BOOLEAN NOT NULL,
																ID_LINEA_VEHICULO INT NOT NULL,
																ID_MARCA_VEHICULO INT NOT NULL,
																ID_TIPO_VEHICULO INT NOT NULL,
																ID_CLIENTE INT NOT NULL,
																PRIMARY KEY (PLACA_VEHICULO)
																);

															create table PERFIL
																(
																	ID_VEHICULO VARCHAR(45) NOT NULL,
																	ID_CLIENTE INT NOT NULL,
																	PRIMARY KEY(ID_VEHICULO, ID_CLIENTE)
																	);

																create table CLIENTE
																	(
																		ID_CLIENTE INT NOT NULL,
																		DIRRECION_C VARCHAR(45)NOT NULL,
																		CORREO_C VARCHAR(45) NOT NULL,
																		HUELLA VARCHAR(45) NOT NULL,
																		ESTADO_CLIENTE BOOLEAN NOT NULL,
																		ID_ACUDIENTE INT NOT NULL,
																		ID_TIPO_DOCUMENTO VARCHAR(45) NOT NULL,
																		ID_LOCALIDAD INT NOT NULL,
																		ID_USUARIO INT NOT NULL,
																		ID_EPS INT NOT NULL,
																		ID_CIUDAD INT NOT NULL,
																		ID_RH INT NOT NULL,
																		PRIMARY KEY(ID_CLIENTE)
																		);

																	create table BENEFICIARIO
																		(
																			ID_BENEFICIARIO INT NOT NULL,
																			ID_PLACA VARCHAR (45)NOT NULL,
																			CELULAR INT NOT NULL,
																			DIRECCION VARCHAR(45) NOT NULL,
																			HUELLA VARCHAR(45)NOT NULL,
																			ESTADO_BENEFICIARIO BOOLEAN NOT NULL,
																			ID_CLIENTE INT not NULL,
																			PRIMARY KEY(ID_BENEFICIARIO)
																			);
																		
																		create table LOGIN
																			(
																				ID_LOGIN INT NOT NULL, 
																				NUMERO_DOCUMENTO INT NOT NULL,
																				ID_TIPO_DOCUMENTO VARCHAR(45) NOT NULL,
																				ID_RECUPERACION INT NOT NULL,
																				ID_ROL INT NOT NULL,
																				PRIMARY KEY (ID_LOGIN)
																				);

-- LLAVES FORANEAS--

-- llaves foraneas de TELEFONO--
ALTER table TELEFONO 
add constraint  PERSONA_TELEFONO
foreign key (ID_PERSONA)
references PERSONA(ID_PERSONA)
ON DELETE CASCADE ;

--LLAVES FORANEAS DE BENEFICIARIO--
alter table BENEFICIARIO
add constraint BENEFIIARIO_VEHICULO
foreign key (ID_PLACA)
references VEHICULO(PLACA_VEHICULO)
ON DELETE CASCADE ;

alter table BENEFICIARIO
add constraint EBNEFICIARIO_CLIENTE
foreign KEY (ID_CLIENTE)
references CLIENTE (ID_CLIENTE)
ON DELETE CASCADE ;

--LLAVES FORANEAS PERFIL--
alter table PERFIL 
add constraint cliente_perfil
foreign key (ID_CLIENTE)
references CLIENTE(ID_CLIENTE)
ON DELETE CASCADE ;

alter table PERFIL
add constraint VEHICULO_PERFILL
foreign key (ID_VEHICULO)
references VEHICULO(PLACA_VEHICULO)
ON DELETE CASCADE ;

-- llaves foraneas LOGIN--
alter table LOGIN
add constraint LOGIN_TDOC
foreign key (ID_TIPO_DOCUMENTO)
references TIPO_DOCUMENTO(ID_TIPO_DOCUMENTO)
ON DELETE CASCADE ;

alter table LOGIN
add constraint RECUPERACION_LOGIN
foreign key (ID_RECUPERACION)
references RECUPERCION_CONTRASENA(ID_RECUPERACION)
ON DELETE CASCADE ;

alter table LOGIN
add constraint ROL_LOGIN
foreign key (ID_ROL)
references ROL (ID_ROL)
ON DELETE CASCADE ;

-- LLAVES FORANEAS USUARIO --
alter table USUARIO
add constraint ROL_USUARIO
foreign key (ID_ROL)
references ROL(ID_ROL)
ON DELETE CASCADE ;

alter table USUARIO
add constraint ROL_CONTRASENA
foreign key (ID_CONTRASENA)
references CAMBIO_CONTRASENA(ID_CONTRASENA)
ON DELETE CASCADE ;

alter table USUARIO
add constraint T_DOC_USUARIO
foreign key (TIPO_DOCIMENTO)
references TIPO_DOCUMENTO(ID_TIPO_DOCUMENTO)
ON DELETE CASCADE ;

	--LLAVES FORANEAS CLIENTE--

	ALTER TABLE CLIENTE
	add constraint CLIENTE_TDOC
	foreign KEY (ID_TIPO_DOCUMENTO)
	references TIPO_DOCUMENTO(ID_TIPO_DOCUMENTO)
	ON DELETE CASCADE ; 

	alter TABLE CLIENTE
	add constraint ACUDIENTE_CLIENTE
	foreign key (ID_ACUDIENTE)
	references ACUDIENTE(ID_ACUDIENTE)
	ON DELETE CASCADE ;

	alter TABLE CLIENTE
	add constraint LOCALIDAD_CLIENTE
	foreign key (ID_LOCALIDAD)
	references LOCALIDAD(ID_LOCALIDAD)
	ON DELETE CASCADE ;

 alter table CLIENTE
 add constraint USUARIO_CLIENTE
 foreign key (ID_USUARIO)
 references USUARIO(ID_USUARIO)
 ON DELETE CASCADE ;

 alter table CLIENTE
 add constraint EPS_CLIENTE
 foreign key(ID_EPS)
 references EPS(ID_EPS)
 ON DELETE CASCADE ;

 alter table CLIENTE
 add constraint CIUDDA_CLIENTE
 foreign KEY (ID_CIUDAD)
 references CIUDAD(ID_CIUDAD)
 ON DELETE CASCADE ;

 alter table CLIENTE
 add constraint RH_CLIENTE
 foreign KEY (ID_RH)
 references RH(ID_RH)
 ON DELETE CASCADE ;

 -- LLAVES FOREANEAS VEHICULO--
 alter table VEHICULO
 add constraint LINEA_VEHICULOO
 foreign KEY (ID_LINEA_VEHICULO)
 references LINEA_VEHICULO(ID_LINEA_VEH)
 ON DELETE CASCADE ;
 


 alter table VEHICULO
 add constraint MARCA_VEHICULOO
 foreign key (ID_MARCA_VEHICULO)
 references MARCA_VEHICULO(ID_MARCA_VEH)
 ON DELETE CASCADE ;

 alter table VEHICULO
 add constraint TIPO_VEHICULOO
 foreign KEY (ID_TIPO_VEHICULO)
 references TIPO_VEHICULO(ID_TIPO_VEH)
 ON DELETE CASCADE ;

 alter table VEHICULO
 add constraint CLIENTE_VEHICULO
 foreign key(ID_CLIENTE)
 references CLIENTE(ID_CLIENTE)
 ON DELETE CASCADE ;
